<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Schillinger SDK Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
      }
      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }
      .metric-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .metric-value {
        font-size: 2em;
        font-weight: bold;
        color: #333;
      }
      .metric-label {
        color: #666;
        margin-top: 5px;
      }
      .chart-container {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .status-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }
      .status-healthy {
        background-color: #4caf50;
      }
      .status-warning {
        background-color: #ff9800;
      }
      .status-error {
        background-color: #f44336;
      }
      .refresh-button {
        background: #667eea;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin-bottom: 20px;
      }
      .refresh-button:hover {
        background: #5a6fd8;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>ðŸŽµ Schillinger SDK Dashboard</h1>
      <p>Real-time monitoring and analytics for the Schillinger System SDK</p>
    </div>

    <button class="refresh-button" onclick="refreshData()">
      ðŸ”„ Refresh Data
    </button>

    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value" id="api-response-time">--</div>
        <div class="metric-label">Average Response Time (ms)</div>
      </div>
      <div class="metric-card">
        <div class="metric-value" id="success-rate">--</div>
        <div class="metric-label">Success Rate (%)</div>
      </div>
      <div class="metric-card">
        <div class="metric-value" id="active-users">--</div>
        <div class="metric-label">Active Users (24h)</div>
      </div>
      <div class="metric-card">
        <div class="metric-value" id="error-count">--</div>
        <div class="metric-label">Errors (1h)</div>
      </div>
    </div>

    <div class="chart-container">
      <h3>API Response Times</h3>
      <canvas id="responseTimeChart" width="400" height="200"></canvas>
    </div>

    <div class="chart-container">
      <h3>SDK Usage by Language</h3>
      <canvas id="languageChart" width="400" height="200"></canvas>
    </div>

    <div class="chart-container">
      <h3>Service Health Status</h3>
      <div id="health-status">
        <p>
          <span class="status-indicator status-healthy"></span>Core API: Healthy
        </p>
        <p>
          <span class="status-indicator status-healthy"></span>Analytics:
          Healthy
        </p>
        <p>
          <span class="status-indicator status-warning"></span>Error Reporting:
          Degraded
        </p>
        <p>
          <span class="status-indicator status-healthy"></span>Documentation:
          Healthy
        </p>
      </div>
    </div>

    <script>
      // Configuration
      const API_BASE_URL = window.location.origin + '/api/metrics';

      // Initialize charts
      let responseTimeChart, languageChart;

      function initCharts() {
        // Response Time Chart
        const responseTimeCtx = document
          .getElementById('responseTimeChart')
          .getContext('2d');
        responseTimeChart = new Chart(responseTimeCtx, {
          type: 'line',
          data: {
            labels: [],
            datasets: [
              {
                label: 'Response Time (ms)',
                data: [],
                borderColor: '#667eea',
                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                tension: 0.4,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });

        // Language Usage Chart
        const languageCtx = document
          .getElementById('languageChart')
          .getContext('2d');
        languageChart = new Chart(languageCtx, {
          type: 'doughnut',
          data: {
            labels: ['TypeScript', 'Python', 'Swift', 'C++'],
            datasets: [
              {
                data: [45, 30, 15, 10],
                backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#f5576c'],
              },
            ],
          },
          options: {
            responsive: true,
          },
        });
      }

      // Fetch metrics data
      async function fetchMetrics() {
        try {
          // Simulate API call - replace with actual endpoint
          const mockData = {
            responseTime: Math.floor(Math.random() * 200) + 100,
            successRate: (Math.random() * 5 + 95).toFixed(1),
            activeUsers: Math.floor(Math.random() * 1000) + 500,
            errorCount: Math.floor(Math.random() * 10),
            responseTimeHistory: Array.from(
              { length: 10 },
              () => Math.floor(Math.random() * 200) + 100
            ),
            languageUsage: {
              typescript: Math.floor(Math.random() * 50) + 30,
              python: Math.floor(Math.random() * 40) + 20,
              swift: Math.floor(Math.random() * 20) + 10,
              cpp: Math.floor(Math.random() * 15) + 5,
            },
          };

          return mockData;
        } catch (error) {
          console.error('Failed to fetch metrics:', error);
          return null;
        }
      }

      // Update dashboard with new data
      async function updateDashboard() {
        const data = await fetchMetrics();
        if (!data) return;

        // Update metric cards
        document.getElementById('api-response-time').textContent =
          data.responseTime;
        document.getElementById('success-rate').textContent = data.successRate;
        document.getElementById('active-users').textContent =
          data.activeUsers.toLocaleString();
        document.getElementById('error-count').textContent = data.errorCount;

        // Update response time chart
        const now = new Date();
        responseTimeChart.data.labels.push(now.toLocaleTimeString());
        responseTimeChart.data.datasets[0].data.push(data.responseTime);

        // Keep only last 10 data points
        if (responseTimeChart.data.labels.length > 10) {
          responseTimeChart.data.labels.shift();
          responseTimeChart.data.datasets[0].data.shift();
        }

        responseTimeChart.update();

        // Update language chart
        languageChart.data.datasets[0].data = [
          data.languageUsage.typescript,
          data.languageUsage.python,
          data.languageUsage.swift,
          data.languageUsage.cpp,
        ];
        languageChart.update();
      }

      // Refresh data manually
      function refreshData() {
        updateDashboard();
      }

      // Initialize dashboard
      document.addEventListener('DOMContentLoaded', function () {
        initCharts();
        updateDashboard();

        // Auto-refresh every 30 seconds
        setInterval(updateDashboard, 30000);
      });
    </script>
  </body>
</html>
